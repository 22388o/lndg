<!DOCTYPE html>
<html>
  <style>
  </style>
  <head>
    {% load static %}
    {% load humanize %}
    <link href="{% static 'w3style.css' %}" rel="stylesheet" type="text/css">
  </head>
  <body>
    <div class="w3-container"></div>
      <h1>My Lnd Overview</h1>
    </div>
    <div class="w3-container w3-padding-small">
      <h4>Total Wallet Balance: {{ balances.total_balance|intcomma }}</h4>
      <h4>Confirmed Wallet Balance: {{ balances.confirmed_balance|intcomma }}</h4>
      <h4>Unconfirmed Wallet Balance: {{ balances.unconfirmed_balance|intcomma }}</h4>
    </div>
    <div class="w3-container w3-padding-small">
      <h4>Total Completed Payments: {{ total_payments }}</h4>
      <h4>Total Sats Sent: {{ total_sent|intcomma }}</h4>
      <h4>Total Fees Paid: {{ fees_paid|intcomma }}</h4>
    </div>
    <div class="w3-container w3-padding-small">
      <h4>Total Paid Invoices: {{ total_invoices }}</h4>
      <h4>Total Sats Received: {{ total_received|intcomma }}</h4>
    </div>
    <div class="w3-container w3-padding-small">
      <h4>Total Payments Routed: {{ total_forwards }}</h4>
      <h4>Total Fees Earned: {{ earned|intcomma }}</h4>
    </div>
    <div class="w3-container w3-padding-small">
      <h4>Total Node Capacity: {{ capacity|intcomma }}</h4>
      <h4>Total Inbound Liquidity: {{ inbound|intcomma }}</h4>
      <h4>Total Outbound Liquidity: {{ outbound|intcomma }}</h4>
    </div>
    <div class="w3-container w3-padding-small">
      <h2>Active Channels</h2>
      <table class="w3-table-all w3-centered w3-hoverable">
        <tr>
          <th width=30%>Peer PubKey</th>
          <th>Channel Alias</th>
          <th>Channel ID</th>
          <th>Capacity</th>
          <th>Outbound Liquidity</th>
          <th width=20%></th>
          <th>Inbound Liquidity</th>
          <th>Initiated By Me</th>
        </tr>
        {% for channel in active_channels %}
        <tr>
          <td>{{ channel.remote_pubkey }}</td>
          <td>{{ channel.alias }}</td>
          <td>{{ channel.chan_id }}</td>
          <td>{{ channel.capacity|intcomma }}</td>
          <td>{{ channel.local_balance|intcomma }}</td>
          <td><div class="w3-orange w3-round"><div class="w3-container w3-round w3-blue" style="height:16px;width:{% widthratio channel.visual 1 100 %}%"></div></div></td>
          <td>{{ channel.remote_balance|intcomma }}</td>
          <td>{{ channel.initiator }}</td>
        </tr>
        {% endfor %}
      </table>
    </div>
    {% if inactive_channels %}
    <div class="w3-container w3-padding-small">
      <h2>Inactive Channels</h2>
      <table class="w3-table-all w3-centered w3-hoverable">
        <tr>
          <th width=30%>Peer PubKey</th>
          <th>Channel Alias</th>
          <th>Channel ID</th>
          <th>Capacity</th>
          <th>Local Balance</th>
          <th>Remote Balance</th>
          <th>Initiated By Me</th>
        </tr>
        {% for channel in inactive_channels %}
        <tr>
          <td>{{ channel.remote_pubkey }}</td>
          <td>{{ channel.alias }}</td>
          <td>{{ channel.chan_id }}</td>
          <td>{{ channel.capacity|intcomma }}</td>
          <td>{{ channel.local_balance|intcomma }}</td>
          <td>{{ channel.remote_balance|intcomma }}</td>
          <td>{{ channel.initiator }}</td>
        </tr>
        {% endfor %}
      </table>
    </div>
    {% endif %}
    <div class="w3-container w3-padding-small">
      <h2>Payments Routed</h2>
      <table class="w3-table-all w3-centered w3-hoverable">
        <tr>
          <th>Timestamp</th>
          <th>Channel In Alias</th>
          <th>Channel In Id</th>
          <th>Channel Out Alias</th>
          <th>Channel Out Id</th>
          <th>Amount In</th>
          <th>Amount Out</th>
          <th>Fees Earned</th>
        </tr>
        {% for forward in forwards %}
        <tr>
          <td>{{ forward.forward_date|naturaltime }}</td>
          <td>{{ forward.chan_in_alias }}</td>
          <td>{{ forward.chan_id_in }}</td>
          <td>{{ forward.chan_out_alias }}</td>
          <td>{{ forward.chan_id_out }}</td>
          <td>{{ forward.amt_in|intcomma }}</td>
          <td>{{ forward.amt_out|intcomma }}</td>
          <td>{{ forward.fee }}</td>
        </tr>
        {% endfor %}
      </table>
    </div>
    <div class="w3-container w3-padding-small">
      <h2>Payments Sent</h2>
      <table class="w3-table-all w3-centered w3-hoverable">
        <tr>
          <th>Timestamp</th>
          <th width=30%>Hash</th>
          <th>Value</th>
          <th>Fee Paid</th>
          <th>Status</th>
        </tr>
        {% for payment in payments %}
        <tr>
          <td>{{ payment.creation_date|naturaltime }}</td>
          <td>{{ payment.payment_hash }}</td>
          <td>{{ payment.value|intcomma }}</td>
          <td>{{ payment.fee }}</td>
          <td>{% if payment.status == 2 %}Success{% elif payment.status == 3 %}Failed{% else %}{{ payment.status }}{% endif %}</td>
        </tr>
        {% endfor %}
      </table>
    </div>
    <div class="w3-container w3-padding-small">
      <h2>Payments Received</h2>
      <table class="w3-table-all w3-centered w3-hoverable">
        <tr>
          <th>Created</th>
          <th>Settled</th>
          <th>Value</th>
          <th>Amount Paid</th>
          <th>State</th>
        </tr>
        {% for invoice in invoices %}
        <tr>
          <td>{{ invoice.creation_date|naturaltime }}</td>
          <td>{% if invoice.state == 1 %}{{ invoice.settle_date|naturaltime }}{% else %}N/A{% endif %}</td>
          <td>{{ invoice.value|intcomma }}</td>
          <td>{% if invoice.state == 1 %}{{ invoice.amt_paid|intcomma }}{% else %}N/A{% endif %}</td>
          <td>{% if invoice.state == 1 %}Settled{% elif invoice.state == 2 %}Canceled{% else %}{{ invoice.state }}{% endif %}</td>
        </tr>
        {% endfor %}
      </table>
    </div>
  </body>
</html>
